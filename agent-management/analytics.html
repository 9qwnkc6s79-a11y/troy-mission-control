<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Dashboard - Agent Management</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">
    <style>
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .chart-container {
            background: var(--dark-surface);
            border-radius: var(--radius);
            padding: 1.5rem;
            position: relative;
        }
        
        .chart-placeholder {
            background: var(--dark-elevated);
            border-radius: var(--radius);
            height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 0.9rem;
            border: 2px dashed var(--border-color);
        }
        
        .metric-card {
            background: var(--dark-surface);
            border-radius: var(--radius);
            padding: 1.5rem;
            text-align: center;
            border-left: 4px solid var(--primary-color);
        }
        
        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            display: block;
            margin-bottom: 0.5rem;
        }
        
        .metric-label {
            color: var(--text-muted);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .metric-change {
            font-size: 0.85rem;
            margin-top: 0.5rem;
        }
        
        .metric-change.positive {
            color: var(--success-color);
        }
        
        .metric-change.negative {
            color: var(--danger-color);
        }
        
        .cost-breakdown {
            background: var(--dark-surface);
            border-radius: var(--radius);
            padding: 1.5rem;
        }
        
        .cost-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .cost-item:last-child {
            border-bottom: none;
        }
        
        .cost-agent {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .cost-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
        }
        
        .cost-details {
            flex: 1;
        }
        
        .cost-name {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }
        
        .cost-stats {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .cost-amount {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .optimization-card {
            background: var(--dark-surface);
            border-radius: var(--radius);
            padding: 1.5rem;
            border-left: 4px solid var(--warning-color);
        }
        
        .recommendation {
            background: var(--dark-elevated);
            border-radius: var(--radius);
            padding: 1rem;
            margin: 0.5rem 0;
            border-left: 3px solid var(--success-color);
        }
        
        .recommendation-impact {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 0.5rem;
        }
        
        .impact-value {
            color: var(--success-color);
            font-weight: 600;
        }
        
        .time-selector {
            background: var(--dark-surface);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            margin-right: 1rem;
        }
        
        .performance-table {
            background: var(--dark-surface);
            border-radius: var(--radius);
            overflow: hidden;
        }
        
        .table-header {
            background: var(--dark-elevated);
            padding: 1rem;
            font-weight: 600;
            border-bottom: 1px solid var(--border-color);
        }
        
        .performance-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr 1fr 100px;
            gap: 1rem;
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            align-items: center;
        }
        
        .performance-row:last-child {
            border-bottom: none;
        }
        
        .performance-row:hover {
            background: rgba(255, 255, 255, 0.02);
        }
        
        .efficiency-score {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .score-bar {
            width: 60px;
            height: 8px;
            background: var(--dark-bg);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .score-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .trend-indicator {
            font-size: 0.8rem;
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-weight: 500;
        }
        
        .trend-up {
            background: rgba(40, 167, 69, 0.2);
            color: var(--success-color);
        }
        
        .trend-down {
            background: rgba(220, 53, 69, 0.2);
            color: var(--danger-color);
        }
        
        .trend-stable {
            background: rgba(255, 193, 7, 0.2);
            color: var(--warning-color);
        }
        
        .alert-banner {
            background: linear-gradient(135deg, var(--warning-color), #ff6b35);
            color: #000;
            padding: 1rem;
            border-radius: var(--radius);
            margin-bottom: 1rem;
            font-weight: 500;
        }
        
        .alert-banner.info {
            background: linear-gradient(135deg, var(--info-color), var(--primary-color));
            color: white;
        }
        
        .forecast-section {
            background: var(--dark-surface);
            border-radius: var(--radius);
            padding: 1.5rem;
        }
        
        .forecast-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .forecast-item:last-child {
            border-bottom: none;
        }
        
        .forecast-period {
            font-weight: 500;
        }
        
        .forecast-amount {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .export-section {
            display: flex;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <header class="header">
        <nav class="nav container">
            <a href="dashboard.html" class="nav-brand">ü§ñ Agent Command Center</a>
            <div class="nav-links">
                <a href="dashboard.html" class="nav-link">Dashboard</a>
                <a href="cron-manager.html" class="nav-link">Cron Jobs</a>
                <a href="profiles/" class="nav-link">Profiles</a>
                <a href="communication-hub.html" class="nav-link">Communication</a>
                <a href="analytics.html" class="nav-link active">Analytics</a>
            </div>
        </nav>
    </header>

    <main class="container" style="padding-top: 2rem;">
        <!-- Header and Controls -->
        <section class="mb-3">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <div>
                        <h1 class="card-title">Analytics & Performance Dashboard</h1>
                        <p class="card-subtitle">Cost optimization and performance insights for your agent fleet</p>
                    </div>
                    <div class="d-flex align-items-center gap-2">
                        <select class="time-selector" id="time-range">
                            <option value="today">Today</option>
                            <option value="week" selected>This Week</option>
                            <option value="month">This Month</option>
                            <option value="quarter">This Quarter</option>
                            <option value="year">This Year</option>
                        </select>
                        <button class="btn" onclick="analytics.exportData()">üìä Export</button>
                        <button class="btn btn-primary" onclick="analytics.refreshData()">üîÑ Refresh</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Alerts and Notifications -->
        <section class="mb-3" id="alerts-section">
            <div class="alert-banner">
                üí° <strong>Optimization Opportunity:</strong> You could save $4.50/day by switching 3 agents to more cost-effective models for routine tasks.
            </div>
        </section>

        <!-- Key Metrics Overview -->
        <section class="mb-3">
            <div class="grid grid-4">
                <div class="metric-card">
                    <span class="metric-value" id="total-cost">$42.30</span>
                    <div class="metric-label">Total Cost (Week)</div>
                    <div class="metric-change positive">‚Üó +12.3% from last week</div>
                </div>
                <div class="metric-card">
                    <span class="metric-value" id="total-tokens">1.2M</span>
                    <div class="metric-label">Tokens Processed</div>
                    <div class="metric-change positive">‚Üó +8.7% from last week</div>
                </div>
                <div class="metric-card">
                    <span class="metric-value" id="avg-efficiency">92.5%</span>
                    <div class="metric-label">Avg Efficiency</div>
                    <div class="metric-change positive">‚Üó +3.2% from last week</div>
                </div>
                <div class="metric-card">
                    <span class="metric-value" id="cost-per-task">$0.034</span>
                    <div class="metric-label">Cost per Task</div>
                    <div class="metric-change negative">‚Üò -5.1% from last week</div>
                </div>
            </div>
        </section>

        <!-- Charts Section -->
        <section class="mb-3">
            <div class="grid grid-2">
                <div class="chart-container">
                    <h3 class="mb-2">Cost Trends</h3>
                    <div class="chart-placeholder">
                        üìà Cost trends over time<br>
                        <small>Daily spending patterns and forecasts</small>
                    </div>
                </div>
                <div class="chart-container">
                    <h3 class="mb-2">Token Usage by Agent</h3>
                    <div class="chart-placeholder">
                        ü•ß Token distribution chart<br>
                        <small>Token consumption breakdown by agent</small>
                    </div>
                </div>
            </div>
        </section>

        <!-- Cost Breakdown and Performance -->
        <section class="mb-3">
            <div class="grid grid-2">
                <!-- Cost Breakdown -->
                <div class="cost-breakdown">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h3>Cost Breakdown by Agent</h3>
                        <span class="text-muted">This Week</span>
                    </div>
                    <div id="cost-breakdown-list">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>

                <!-- Performance Table -->
                <div class="performance-table">
                    <div class="table-header">
                        Agent Performance Metrics
                    </div>
                    <div class="performance-row" style="font-weight: 600; color: var(--text-muted); font-size: 0.9rem;">
                        <div>Agent</div>
                        <div>Efficiency</div>
                        <div>Avg Response</div>
                        <div>Success Rate</div>
                        <div>Cost/Token</div>
                        <div>Trend</div>
                    </div>
                    <div id="performance-data">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Optimization Recommendations -->
        <section class="mb-3">
            <div class="optimization-card">
                <h3 class="mb-3">üí° Optimization Recommendations</h3>
                <div id="recommendations-list">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Advanced Analytics -->
        <section class="mb-3">
            <div class="grid grid-2">
                <!-- Cost Forecast -->
                <div class="forecast-section">
                    <h3 class="mb-3">üìà Cost Forecast</h3>
                    <div id="cost-forecast">
                        <div class="forecast-item">
                            <div class="forecast-period">Next 7 days</div>
                            <div class="forecast-amount">$48.20</div>
                        </div>
                        <div class="forecast-item">
                            <div class="forecast-period">Next 30 days</div>
                            <div class="forecast-amount">$186.40</div>
                        </div>
                        <div class="forecast-item">
                            <div class="forecast-period">End of quarter</div>
                            <div class="forecast-amount">$520.30</div>
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <h4>Budget Tracking</h4>
                        <div class="d-flex justify-content-between mb-1">
                            <span>Monthly Budget</span>
                            <span>$200.00</span>
                        </div>
                        <div class="progress">
                            <div class="progress-bar" style="width: 68%"></div>
                        </div>
                        <small class="text-muted">$136.50 used ‚Ä¢ $63.50 remaining</small>
                    </div>
                </div>

                <!-- Detailed Charts -->
                <div class="chart-container">
                    <h3 class="mb-2">Response Time Trends</h3>
                    <div class="chart-placeholder">
                        ‚ö° Response time analysis<br>
                        <small>Performance trends over time</small>
                    </div>
                </div>
            </div>
        </section>

        <!-- Export and Reporting -->
        <section class="mb-3">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">üìã Reports & Export</h3>
                </div>
                <div class="export-section">
                    <button class="btn" onclick="analytics.exportCostReport()">
                        üí∞ Cost Report
                    </button>
                    <button class="btn" onclick="analytics.exportPerformanceReport()">
                        ‚ö° Performance Report
                    </button>
                    <button class="btn" onclick="analytics.exportOptimizationReport()">
                        üîß Optimization Report
                    </button>
                    <button class="btn" onclick="analytics.exportFullReport()">
                        üìä Complete Analytics
                    </button>
                    <button class="btn" onclick="analytics.scheduleReport()">
                        üìÖ Schedule Reports
                    </button>
                </div>
                
                <div class="mt-3">
                    <h4>Recent Reports</h4>
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Report Type</th>
                                    <th>Generated</th>
                                    <th>Period</th>
                                    <th>Size</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Weekly Performance</td>
                                    <td>Feb 10, 2026 9:00 AM</td>
                                    <td>Feb 3-9, 2026</td>
                                    <td>2.3 MB</td>
                                    <td>
                                        <button class="btn btn-sm">üì• Download</button>
                                        <button class="btn btn-sm">üëÅÔ∏è View</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Cost Analysis</td>
                                    <td>Feb 9, 2026 6:00 PM</td>
                                    <td>January 2026</td>
                                    <td>1.8 MB</td>
                                    <td>
                                        <button class="btn btn-sm">üì• Download</button>
                                        <button class="btn btn-sm">üëÅÔ∏è View</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script src="assets/js/main.js"></script>
    <script>
        class Analytics {
            constructor() {
                this.timeRange = 'week';
                this.agents = [];
                this.costData = {};
                this.performanceData = {};
                this.init();
            }

            async init() {
                await this.loadData();
                this.renderCostBreakdown();
                this.renderPerformanceTable();
                this.renderRecommendations();
                this.setupEventListeners();
                this.startDataPolling();
            }

            setupEventListeners() {
                document.getElementById('time-range').addEventListener('change', (e) => {
                    this.timeRange = e.target.value;
                    this.loadData();
                    this.updateAllViews();
                });
            }

            async loadData() {
                // Use existing agent data
                this.agents = agentManager.getMockAgents();
                
                // Generate mock analytics data
                this.generateMockAnalytics();
                this.updateMetrics();
            }

            generateMockAnalytics() {
                // Cost data
                this.costData = {
                    'agent-dev': { cost: 15.20, tokens: 67840, efficiency: 89.5, responseTime: 2.1, successRate: 94.2 },
                    'agent-main': { cost: 12.45, tokens: 45230, efficiency: 95.8, responseTime: 1.2, successRate: 98.1 },
                    'agent-business': { cost: 8.85, tokens: 28930, efficiency: 91.2, responseTime: 1.5, successRate: 96.3 },
                    'agent-health': { cost: 3.25, tokens: 12450, efficiency: 88.7, responseTime: 0.8, successRate: 92.8 },
                    'agent-content': { cost: 2.55, tokens: 19320, efficiency: 85.3, responseTime: 1.1, successRate: 89.4 }
                };

                // Performance trends
                this.performanceData = {
                    trends: {
                        'agent-dev': 'stable',
                        'agent-main': 'up',
                        'agent-business': 'up',
                        'agent-health': 'stable',
                        'agent-content': 'down'
                    }
                };
            }

            renderCostBreakdown() {
                const container = document.getElementById('cost-breakdown-list');
                container.innerHTML = '';

                // Sort agents by cost
                const sortedAgents = this.agents.sort((a, b) => 
                    (this.costData[b.id]?.cost || 0) - (this.costData[a.id]?.cost || 0));

                sortedAgents.forEach(agent => {
                    const cost = this.costData[agent.id]?.cost || 0;
                    const tokens = this.costData[agent.id]?.tokens || 0;
                    const avatar = agent.name.split(' ').map(n => n[0]).join('');

                    const costItem = document.createElement('div');
                    costItem.className = 'cost-item';
                    costItem.innerHTML = `
                        <div class="cost-agent">
                            <div class="cost-avatar">${avatar}</div>
                            <div class="cost-details">
                                <div class="cost-name">${agent.name}</div>
                                <div class="cost-stats">${(tokens / 1000).toFixed(1)}k tokens ‚Ä¢ ${agent.model}</div>
                            </div>
                        </div>
                        <div class="cost-amount">$${cost.toFixed(2)}</div>
                    `;
                    container.appendChild(costItem);
                });
            }

            renderPerformanceTable() {
                const container = document.getElementById('performance-data');
                container.innerHTML = '';

                this.agents.forEach(agent => {
                    const data = this.costData[agent.id] || {};
                    const trend = this.performanceData.trends[agent.id] || 'stable';
                    const avatar = agent.name.split(' ').map(n => n[0]).join('');

                    const row = document.createElement('div');
                    row.className = 'performance-row';
                    row.innerHTML = `
                        <div class="d-flex align-items-center gap-2">
                            <div class="cost-avatar" style="width: 24px; height: 24px; font-size: 0.7rem;">${avatar}</div>
                            ${agent.name}
                        </div>
                        <div class="efficiency-score">
                            <span>${data.efficiency?.toFixed(1) || 0}%</span>
                            <div class="score-bar">
                                <div class="score-fill" style="width: ${data.efficiency || 0}%; background: ${this.getEfficiencyColor(data.efficiency)}"></div>
                            </div>
                        </div>
                        <div>${data.responseTime?.toFixed(1) || 0}s</div>
                        <div>${data.successRate?.toFixed(1) || 0}%</div>
                        <div>$${((data.cost / data.tokens) * 1000).toFixed(4) || 0}</div>
                        <div>
                            <span class="trend-indicator trend-${trend}">
                                ${trend === 'up' ? '‚Üó' : trend === 'down' ? '‚Üò' : '‚Üí'}
                            </span>
                        </div>
                    `;
                    container.appendChild(row);
                });
            }

            getEfficiencyColor(efficiency) {
                if (efficiency >= 90) return 'var(--success-color)';
                if (efficiency >= 75) return 'var(--warning-color)';
                return 'var(--danger-color)';
            }

            renderRecommendations() {
                const container = document.getElementById('recommendations-list');
                const recommendations = [
                    {
                        title: "Switch Content Agent to Claude Haiku",
                        description: "For routine content tasks, Claude Haiku would be 60% more cost-effective while maintaining quality.",
                        impact: "$2.50/day savings",
                        difficulty: "Easy"
                    },
                    {
                        title: "Optimize Development Agent Memory",
                        description: "Archive old memory files to improve response times and reduce token usage.",
                        impact: "15% faster responses",
                        difficulty: "Medium"
                    },
                    {
                        title: "Batch Similar Cron Jobs",
                        description: "Combine health check tasks to reduce redundant API calls and processing.",
                        impact: "$1.20/day savings",
                        difficulty: "Easy"
                    },
                    {
                        title: "Implement Smart Routing",
                        description: "Route simple queries to lower-cost models automatically based on complexity analysis.",
                        impact: "$3.80/day savings",
                        difficulty: "Hard"
                    }
                ];

                container.innerHTML = recommendations.map(rec => `
                    <div class="recommendation">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <strong>${rec.title}</strong>
                            <span class="btn btn-sm btn-primary">Apply</span>
                        </div>
                        <p class="mb-2">${rec.description}</p>
                        <div class="recommendation-impact">
                            <span class="text-muted">Difficulty: ${rec.difficulty}</span>
                            <span class="impact-value">${rec.impact}</span>
                        </div>
                    </div>
                `).join('');
            }

            updateMetrics() {
                const totalCost = Object.values(this.costData).reduce((sum, data) => sum + data.cost, 0);
                const totalTokens = Object.values(this.costData).reduce((sum, data) => sum + data.tokens, 0);
                const avgEfficiency = Object.values(this.costData).reduce((sum, data) => sum + data.efficiency, 0) / this.agents.length;
                const costPerTask = totalCost / (totalTokens / 1000) * 100; // Rough estimate

                document.getElementById('total-cost').textContent = `$${totalCost.toFixed(2)}`;
                document.getElementById('total-tokens').textContent = `${(totalTokens / 1000000).toFixed(1)}M`;
                document.getElementById('avg-efficiency').textContent = `${avgEfficiency.toFixed(1)}%`;
                document.getElementById('cost-per-task').textContent = `$${(costPerTask / 1000).toFixed(3)}`;
            }

            updateAllViews() {
                this.renderCostBreakdown();
                this.renderPerformanceTable();
                this.renderRecommendations();
                this.updateMetrics();
            }

            // Export functions
            exportData() {
                agentManager.showNotification('Preparing export...', 'info');
                
                setTimeout(() => {
                    const exportData = {
                        timeRange: this.timeRange,
                        exportDate: new Date().toISOString(),
                        agents: this.agents,
                        costData: this.costData,
                        performanceData: this.performanceData
                    };
                    
                    this.downloadJSON(exportData, `agent-analytics-${Date.now()}.json`);
                }, 1000);
            }

            exportCostReport() {
                agentManager.showNotification('Generating cost report...', 'info');
                
                const report = {
                    reportType: 'Cost Analysis',
                    period: this.timeRange,
                    totalCost: Object.values(this.costData).reduce((sum, data) => sum + data.cost, 0),
                    costByAgent: this.costData,
                    recommendations: [
                        "Switch to more cost-effective models for routine tasks",
                        "Implement usage quotas for high-cost agents",
                        "Optimize memory management to reduce token usage"
                    ]
                };
                
                setTimeout(() => {
                    this.downloadJSON(report, `cost-report-${Date.now()}.json`);
                    agentManager.showNotification('Cost report generated', 'success');
                }, 1500);
            }

            exportPerformanceReport() {
                agentManager.showNotification('Generating performance report...', 'info');
                
                const report = {
                    reportType: 'Performance Analysis',
                    period: this.timeRange,
                    performanceMetrics: this.costData,
                    trends: this.performanceData.trends,
                    insights: [
                        "Main Agent shows highest efficiency scores",
                        "Development Agent has longest response times due to complex tasks",
                        "Health Agent shows most consistent performance"
                    ]
                };
                
                setTimeout(() => {
                    this.downloadJSON(report, `performance-report-${Date.now()}.json`);
                    agentManager.showNotification('Performance report generated', 'success');
                }, 1500);
            }

            exportOptimizationReport() {
                agentManager.showNotification('Generating optimization report...', 'info');
                
                const report = {
                    reportType: 'Optimization Recommendations',
                    period: this.timeRange,
                    potentialSavings: "$8.50/day",
                    recommendations: [
                        "Model optimization: $4.50/day savings",
                        "Memory management: 15% performance improvement",
                        "Task batching: $1.20/day savings",
                        "Smart routing: $3.80/day savings"
                    ]
                };
                
                setTimeout(() => {
                    this.downloadJSON(report, `optimization-report-${Date.now()}.json`);
                    agentManager.showNotification('Optimization report generated', 'success');
                }, 1500);
            }

            exportFullReport() {
                agentManager.showNotification('Generating complete analytics report...', 'info');
                
                const report = {
                    reportType: 'Complete Analytics',
                    period: this.timeRange,
                    generatedAt: new Date().toISOString(),
                    summary: {
                        totalCost: Object.values(this.costData).reduce((sum, data) => sum + data.cost, 0),
                        totalTokens: Object.values(this.costData).reduce((sum, data) => sum + data.tokens, 0),
                        avgEfficiency: Object.values(this.costData).reduce((sum, data) => sum + data.efficiency, 0) / this.agents.length
                    },
                    detailedMetrics: this.costData,
                    performanceTrends: this.performanceData,
                    agentProfiles: this.agents,
                    recommendations: "See optimization section for detailed recommendations"
                };
                
                setTimeout(() => {
                    this.downloadJSON(report, `complete-analytics-${Date.now()}.json`);
                    agentManager.showNotification('Complete report generated', 'success');
                }, 2000);
            }

            scheduleReport() {
                agentManager.showNotification('Report scheduling coming soon...', 'info');
            }

            downloadJSON(data, filename) {
                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
                
                URL.revokeObjectURL(url);
            }

            refreshData() {
                agentManager.showNotification('Refreshing analytics data...', 'info');
                
                setTimeout(() => {
                    this.loadData();
                    agentManager.showNotification('Data refreshed successfully', 'success');
                }, 1000);
            }

            startDataPolling() {
                // Refresh data every 5 minutes
                setInterval(() => {
                    this.loadData();
                }, 300000);
            }
        }

        // Initialize Analytics Dashboard
        document.addEventListener('DOMContentLoaded', () => {
            window.analytics = new Analytics();
        });
    </script>
</body>
</html>